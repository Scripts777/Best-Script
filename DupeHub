-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π GUI (–µ—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞)
local existing = game.Players.LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("BackpackDupeGUI")
if existing then existing:Destroy() end

local player = game.Players.LocalPlayer
local backpack = player:WaitForChild("Backpack")
local UIS = game:GetService("UserInputService")

-- GUI
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "BackpackDupeGUI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 280, 0, 320)
frame.Position = UDim2.new(0.5, -140, 0.5, -160)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.BorderSizePixel = 0

local titleBar = Instance.new("TextLabel", frame)
titleBar.Size = UDim2.new(1, 0, 0, 20)
titleBar.Text = "üì¶ Backpack Dupe"
titleBar.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
titleBar.TextColor3 = Color3.new(1, 1, 1)
titleBar.Font = Enum.Font.SourceSansBold
titleBar.TextSize = 14
titleBar.TextXAlignment = Enum.TextXAlignment.Left

-- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∑–∞ –≤—Å—é —Ä–∞–º–∫—É
local dragging, dragInput, dragStart, startPos
frame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = frame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)
frame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)
UIS.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		frame.Position = UDim2.new(
			startPos.X.Scale, startPos.X.Offset + delta.X,
			startPos.Y.Scale, startPos.Y.Offset + delta.Y
		)
	end
end)

-- –û—Å—Ç–∞–ª—å–Ω–æ–π GUI
local dropdown = Instance.new("TextButton", frame)
dropdown.Size = UDim2.new(1, -20, 0, 30)
dropdown.Position = UDim2.new(0, 10, 0, 30)
dropdown.Text = "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç"
dropdown.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
dropdown.TextColor3 = Color3.new(1,1,1)

local dropdownFrame = Instance.new("ScrollingFrame", frame)
dropdownFrame.Size = UDim2.new(1, -20, 0, 80)
dropdownFrame.Position = UDim2.new(0, 10, 0, 65)
dropdownFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
dropdownFrame.Visible = false
dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
dropdownFrame.ScrollBarThickness = 6
dropdownFrame.BorderSizePixel = 0

-- –ü–æ–ª—è "–í–µ—Å" –∏ "–í–æ–∑—Ä–∞—Å—Ç"
local function createLabel(parent, text, pos)
	local label = Instance.new("TextLabel", parent)
	label.Position = pos
	label.Size = UDim2.new(0, 60, 0, 20)
	label.Text = text
	label.BackgroundTransparency = 1
	label.TextColor3 = Color3.new(1,1,1)
	label.Font = Enum.Font.SourceSans
	label.TextSize = 14
	label.TextXAlignment = Enum.TextXAlignment.Left
	return label
end

local function createBox(parent, placeholder, pos)
	local box = Instance.new("TextBox", parent)
	box.Position = pos
	box.Size = UDim2.new(0, 60, 0, 20)
	box.PlaceholderText = placeholder
	box.Text = ""
	box.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
	box.TextColor3 = Color3.new(1,1,1)
	box.ClearTextOnFocus = false
	return box
end

createLabel(frame, "–í–µ—Å:", UDim2.new(0, 10, 0, 160))
local weightInput = createBox(frame, "10", UDim2.new(0, 70, 0, 160))

createLabel(frame, "–í–æ–∑—Ä–∞—Å—Ç:", UDim2.new(0, 150, 0, 160))
local ageInput = createBox(frame, "5", UDim2.new(0, 210, 0, 160))

-- –ö–Ω–æ–ø–∫–∏
local dupeOne = Instance.new("TextButton", frame)
dupeOne.Size = UDim2.new(0.48, -5, 0, 30)
dupeOne.Position = UDim2.new(0, 10, 0, 270)
dupeOne.Text = "DUPE"
dupeOne.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
dupeOne.TextColor3 = Color3.new(1,1,1)

local dupeAll = Instance.new("TextButton", frame)
dupeAll.Size = UDim2.new(0.48, -5, 0, 30)
dupeAll.Position = UDim2.new(0.52, 0, 0, 270)
dupeAll.Text = "DUPE –í–°–Å"
dupeAll.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
dupeAll.TextColor3 = Color3.new(1,1,1)

-- –õ–æ–≥–∏–∫–∞
local selectedItem = nil
local clonedInstances = {}

local blockedWords = {
	"Favorite", "Trowel", "Shovel", "Spray",
	"Recall", "Sprinkler", "Glass", "Egg"
}

local function isAllowed(item)
	if item:IsA("ObjectValue") then return false end
	for _, word in ipairs(blockedWords) do
		if string.find(item.Name:lower(), word:lower()) then return false end
	end
	if clonedInstances[item] then return false end
	return true
end

local function updateItemList()
	dropdownFrame:ClearAllChildren()
	local y = 0
	for _, item in pairs(backpack:GetChildren()) do
		if isAllowed(item) then
			local btn = Instance.new("TextButton", dropdownFrame)
			btn.Size = UDim2.new(1, 0, 0, 24)
			btn.Position = UDim2.new(0, 0, 0, y)
			btn.Text = item.Name
			btn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
			btn.TextColor3 = Color3.new(1,1,1)
			btn.TextScaled = true
			btn.MouseButton1Click:Connect(function()
				selectedItem = item
				dropdown.Text = "–í—ã–±—Ä–∞–Ω: " .. item.Name
				dropdownFrame.Visible = false
			end)
			y += 24
		end
	end
	dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, y)
end

dropdown.MouseButton1Click:Connect(function()
	dropdownFrame.Visible = not dropdownFrame.Visible
	if dropdownFrame.Visible then updateItemList() end
end)

local function getLimitedNumber(input, default, max)
	local value = tonumber(input.Text)
	if not value then value = tonumber(input.PlaceholderText) or default end
	return math.clamp(math.floor(value), 0, max)
end

local function getWeight() return getLimitedNumber(weightInput, 10, 100) end
local function getAge() return getLimitedNumber(ageInput, 5, 100) end

local function cloneItem(original)
	local clone = original:Clone()
	local weight = getWeight()
	local age = getAge()

	clone:SetAttribute("Weight", weight)
	clone:SetAttribute("Age", age)

	local cleanName = original.Name:gsub(" %[.-%]", "") -- —É–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—ã–µ [..]
	local formattedWeight = string.format("%.1f", weight)
	clone.Name = cleanName .. " [" .. formattedWeight .. " kg] [Age " .. age .. "]"

	-- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Parent –ø–æ—Å–ª–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
	clone.Parent = backpack
	clonedInstances[original] = true
end

dupeOne.MouseButton1Click:Connect(function()
	if selectedItem and isAllowed(selectedItem) then
		cloneItem(selectedItem)
		updateItemList()
	else
		warn("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç.")
	end
end)

dupeAll.MouseButton1Click:Connect(function()
	local count = 0
	for _, item in pairs(backpack:GetChildren()) do
		if isAllowed(item) then
			cloneItem(item)
			count += 1
		end
	end
	print("
